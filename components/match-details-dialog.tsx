"use client"

import { useState, useEffect } from "react"
import { Dialog, DialogContent, DialogHeader, DialogTitle } from "@/components/ui/dialog"
import { Badge } from "@/components/ui/badge"
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card"
import { supabase } from "@/lib/supabase"
// import Image from "next/image"

interface MatchDetailsDialogProps {
  matchId: number | null
  isOpen: boolean
  onClose: () => void
}

interface PlayerRating {
  id: number
  player_id: number
  team_name: string
  position_played: string
  rating: number
  goals: number
  assists: number
  minutes_played: number
  players: {
    name: string
    position: string
  }
}

interface Match {
  id: number
  match_date: string
  team_a_name: string
  team_b_name: string
  team_a_score: number
  team_b_score: number
  location?: string
  notes?: string
}

export function MatchDetailsDialog({ matchId, isOpen, onClose }: MatchDetailsDialogProps) {
  const [match, setMatch] = useState<Match | null>(null)
  const [playerRatings, setPlayerRatings] = useState<PlayerRating[]>([])
  const [loading, setLoading] = useState(false)

  useEffect(() => {
    if (matchId && isOpen) {
      fetchMatchDetails()
    }
  }, [matchId, isOpen])

  const fetchMatchDetails = async () => {
    if (!matchId) return

    setLoading(true)

    try {
      // Fetch match details
      const { data: matchData, error: matchError } = await supabase
        .from("matches")
        .select("*")
        .eq("id", matchId)
        .single()

      if (matchError) throw matchError
      setMatch(matchData)

      // Fetch player ratings with player names
      const { data: ratingsData, error: ratingsError } = await supabase
        .from("match_player_ratings")
        .select(`
        *,
        players (
          name,
          position
        )
      `)
        .eq("match_id", matchId)
        .order("team_name")
        .order("rating", { ascending: false })

      if (ratingsError) throw ratingsError
      setPlayerRatings(ratingsData || [])
    } catch (error) {
      console.error("Error fetching match details:", error)
    } finally {
      setLoading(false)
    }
  }

  const getTeamPlayers = (teamName: string) => {
    return playerRatings.filter((rating) => rating.team_name === teamName)
  }

  const getTeamStats = (teamName: string) => {
    const teamPlayers = getTeamPlayers(teamName)
    const avgRating =
      teamPlayers.length > 0 ? teamPlayers.reduce((sum, p) => sum + p.rating, 0) / teamPlayers.length : 0
    const totalGoals = teamPlayers.reduce((sum, p) => sum + p.goals, 0)
    const totalAssists = teamPlayers.reduce((sum, p) => sum + p.assists, 0)

    return { avgRating, totalGoals, totalAssists }
  }

  const getRatingColor = (rating: number) => {
    if (rating >= 8.5) return "bg-green-500"
    if (rating >= 7.5) return "bg-green-400"
    if (rating >= 6.5) return "bg-yellow-400"
    if (rating >= 5.5) return "bg-orange-400"
    return "bg-red-400"
  }

  if (!match) return null

  const teamAStats = getTeamStats(match.team_a_name)
  const teamBStats = getTeamStats(match.team_b_name)

  return (
    <Dialog open={isOpen} onOpenChange={onClose}>
      <DialogContent className="max-w-4xl max-h-[90vh] overflow-y-auto">
        <DialogHeader>
          <DialogTitle className="text-xl font-bold">
            Match Details - {new Date(match.match_date).toLocaleDateString()}
          </DialogTitle>
          <div className="text-center text-lg font-semibold">
            {match.team_a_name} {match.team_a_score} - {match.team_b_score} {match.team_b_name}
          </div>
        </DialogHeader>

        {loading ? (
          <div className="flex justify-center py-8">
            <div className="text-muted-foreground">Loading match details...</div>
          </div>
        ) : playerRatings.length === 0 ? (
          <div className="text-center py-8 text-muted-foreground">No player ratings recorded for this match</div>
        ) : (
          <div className="space-y-6">
            {/* Match Summary */}
            <div className="grid grid-cols-2 gap-4">
              <Card>
                <CardHeader className="pb-2">
                  <CardTitle className="text-lg">{match.team_a_name}</CardTitle>
                </CardHeader>
                <CardContent>
                  <div className="space-y-1 text-sm">
                    <div>Score: {match.team_a_score}</div>
                    <div>Avg Rating: {teamAStats.avgRating.toFixed(1)}</div>
                    <div>Goals: {teamAStats.totalGoals}</div>
                    <div>Assists: {teamAStats.totalAssists}</div>
                  </div>
                </CardContent>
              </Card>

              <Card>
                <CardHeader className="pb-2">
                  <CardTitle className="text-lg">{match.team_b_name}</CardTitle>
                </CardHeader>
                <CardContent>
                  <div className="space-y-1 text-sm">
                    <div>Score: {match.team_b_score}</div>
                    <div>Avg Rating: {teamBStats.avgRating.toFixed(1)}</div>
                    <div>Goals: {teamBStats.totalGoals}</div>
                    <div>Assists: {teamBStats.totalAssists}</div>
                  </div>
                </CardContent>
              </Card>
            </div>

            {/* Player Ratings by Team */}
            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
              {/* Team A Players */}
              <div>
                <h3 className="text-lg font-semibold mb-3">{match.team_a_name} Players</h3>
                <div className="space-y-2">
                  {getTeamPlayers(match.team_a_name).map((player) => (
                    <Card key={player.id} className="p-3">
                      <div className="flex items-center justify-between">
                        <div className="flex-1">
                          <div className="font-medium">{player.players.name}</div>
                          <div className="text-sm text-muted-foreground">
                            {player.position_played} • {player.minutes_played}'
                          </div>
                        </div>
                        <div className="flex items-center gap-2">
                          {player.goals > 0 && (
                            <Badge variant="secondary" className="text-xs flex items-center gap-1">
                              <svg width="12" height="12" viewBox="0 0 72.371 72.372" className="w-3 h-3 fill-current">
                                <path
                                  d="M22.57,2.648c-4.489,1.82-8.517,4.496-11.971,7.949C7.144,14.051,4.471,18.08,2.65,22.568C0.892,26.904,0,31.486,0,36.186
    c0,4.699,0.892,9.281,2.65,13.615c1.821,4.489,4.495,8.518,7.949,11.971c3.454,3.455,7.481,6.129,11.971,7.949
    c4.336,1.76,8.917,2.649,13.617,2.649c4.7,0,9.28-0.892,13.616-2.649c4.488-1.82,8.518-4.494,11.971-7.949
    c3.455-3.453,6.129-7.48,7.949-11.971c1.758-4.334,2.648-8.916,2.648-13.615c0-4.7-0.891-9.282-2.648-13.618
    c-1.82-4.488-4.496-8.518-7.949-11.971s-7.479-6.129-11.971-7.949C45.467,0.891,40.887,0,36.187,0
    C31.487,0,26.906,0.891,22.57,2.648z M9.044,51.419c-1.743-1.094-3.349-2.354-4.771-3.838c-2.172-6.112-2.54-12.729-1.101-19.01
    c0.677-1.335,1.447-2.617,2.318-3.845c0.269-0.379,0.518-0.774,0.806-1.142l8.166,4.832c0,0.064,0,0.134,0,0.205
    c-0.021,4.392,0.425,8.752,1.313,13.049c0.003,0.02,0.006,0.031,0.01,0.049l-6.333,9.93C9.314,51.579,9.177,51.503,9.044,51.419z
     M33.324,68.206c1.409,0.719,2.858,1.326,4.347,1.82c-6.325,0.275-12.713-1.207-18.36-4.447L33,68.018
    C33.105,68.085,33.212,68.149,33.324,68.206z M33.274,65.735L17.12,62.856c-1.89-2.295-3.59-4.723-5.051-7.318
    c-0.372-0.66-0.787-1.301-1.102-1.99l6.327-9.92c0.14,0.035,0.296,0.072,0.473,0.119c3.958,1.059,7.986,1.812,12.042,2.402
    c0.237,0.033,0.435,0.062,0.604,0.08l7.584,13.113c-1.316,1.85-2.647,3.69-4.007,5.51C33.764,65.155,33.524,65.446,33.274,65.735z
     M60.15,60.149c-1.286,1.287-2.651,2.447-4.08,3.481c-0.237-1.894-0.646-3.75-1.223-5.563l8.092-15.096
    c2.229-1.015,4.379-2.166,6.375-3.593c0.261-0.185,0.478-0.392,0.646-0.618C69.374,46.561,66.104,54.196,60.15,60.149z
     M59.791,40.571c0.301,0.574,0.598,1.154,0.896,1.742l-7.816,14.58c-0.045,0.01-0.088,0.02-0.133,0.026
    c-4.225,0.789-8.484,1.209-12.779,1.229l-7.8-13.487c1.214-2.254,2.417-4.517,3.61-6.781c0.81-1.536,1.606-3.082,2.401-4.627
    l16.143-1.658C56.29,34.495,58.163,37.457,59.791,40.571z M56.516,23.277c-0.766,2.023-1.586,4.025-2.401,6.031l-15.726,1.615
    c-0.188-0.248-0.383-0.492-0.588-0.725c-1.857-2.103-3.726-4.193-5.592-6.289c0.017-0.021,0.034-0.037,0.051-0.056
    c-0.753-0.752-1.508-1.504-2.261-2.258l4.378-13.181c0.302-0.08,0.606-0.147,0.913-0.18c2.38-0.242,4.763-0.516,7.149-0.654
    c1.461-0.082,2.93-0.129,4.416-0.024l10.832,12.209C57.314,20.943,56.95,22.124,56.516,23.277z M60.15,12.221
    c2.988,2.99,5.302,6.402,6.938,10.047c-2.024-1.393-4.188-2.539-6.463-3.473c-0.354-0.146-0.717-0.275-1.086-0.402L48.877,6.376
    c0.074-0.519,0.113-1.039,0.129-1.563C53.062,6.464,56.864,8.936,60.15,12.221z M25.334,4.182c0.042,0.031,0.062,0.057,0.086,0.064
    c2.437,0.842,4.654,2.082,6.744,3.553l-4.09,12.317c-0.021,0.006-0.041,0.012-0.061,0.021c-0.837,0.346-1.69,0.656-2.514,1.031
    c-3.395,1.543-6.705,3.252-9.823,5.301l-8.071-4.775c0.012-0.252,0.055-0.508,0.141-0.736c0.542-1.444,1.075-2.896,1.688-4.311
    c0.472-1.09,1.01-2.143,1.597-3.172c0.384-0.424,0.782-0.844,1.192-1.254c3.833-3.832,8.363-6.553,13.186-8.162
    C25.384,4.098,25.358,4.139,25.334,4.182z"
                                />
                              </svg>
                              {player.goals}
                            </Badge>
                          )}
                          {player.assists > 0 && (
                            <Badge variant="secondary" className="text-xs flex items-center gap-1">
                              <svg
                                width="12"
                                height="12"
                                viewBox="0 0 495.911 495.911"
                                className="w-3 h-3 fill-current"
                              >
                                <path
                                  d="M444.679,320.672c60.387-17.744,65.879-54.018,24.439-73.301c-6.653-3.096-54.633-25.674-61.21-27.957l-1.89-0.656
c-4.9-1.703-9.97-1.791-14.631-0.547c-2.886-3.867-6.919-6.939-11.819-8.641l-1.889-0.658c-4.9-1.701-9.97-1.789-14.631-0.545
c-2.886-3.865-6.919-6.939-11.819-8.643l-1.889-0.656c-4.9-1.701-9.97-1.791-14.631-0.545c-2.886-3.867-6.919-6.939-11.819-8.643
l-1.889-0.656c-4.9-1.701-9.971-1.791-14.631-0.547c-2.886-3.865-6.919-6.939-11.819-8.643l-1.889-0.654
c-5.659-1.967-11.544-1.777-16.765,0.129c-0.182-0.115-0.379-0.234-0.544-0.346c-14.824-9.994-35.158-26.152-48.939-37.283
c-43.333-35-57.647,1.104-73.656,18.482c-3.361,3.65-3.494,7.916-0.884,12.047c1.987,3.145,4.342,6.057,7.75,10.746
c-12.025,1.246-22.703,2.32-33.373,3.469c-12.947,1.391-23.867-2.697-32.767-12.127c-4.546-4.814-8.502-10.287-13.512-14.535
c-4.026-3.412-21.258-10.304-42.02-2.697C0.284,171.067-2.867,278.825,1.514,304.117c2.834,16.355,7.782,22.074,16.04,24.691
l2.909,5.313l-1.239,12.289c-0.636,6.297,2.879,11.637,8.001,12.154c5.123,0.516,9.636-4.014,10.27-10.311l1.24-12.285
l2.816-3.328c13.27,1.924,26.573,3.512,39.92,4.621l3.438,5.35l-0.378,12.346c-0.193,6.326,3.686,11.408,8.831,11.564
c5.146,0.158,9.332-4.674,9.523-11l0.38-12.344l3.244-4.428c6.442,0.219,38.847-15.259,105.731-2.598
c13.168,2.493,26.641,4.123,39.975,4.148c2.721,0.004,5.442-0.004,8.164-0.014l3.393,4.887l0.066,12.35
c0.033,6.328,4.093,11.268,9.24,11.24c5.149-0.027,9.158-5.008,9.123-11.338l-0.064-12.348l3.472-5.113
c15.932-0.344,31.859-0.949,47.763-1.82c2.788-0.154,5.576-0.318,8.363-0.492c0.09,0.125,0.179,0.248,0.282,0.365l4.744,5.314
l1.565,12.25c0.803,6.279,5.432,10.688,10.538,10.035c5.107-0.654,8.481-6.082,7.679-12.361l-1.565-12.25l2.765-5.379
c17.226-1.678,34.345-4.156,51.202-8.143c0.065,0.063,0.125,0.131,0.194,0.189l5.427,4.617l3.225,11.92
c1.654,6.111,6.843,9.846,11.813,8.5s7.569-7.186,5.915-13.295l-3.226-11.922l2.359-6.721
C444.664,320.74,444.668,320.705,444.679,320.672z M196.221,289.083c-0.86,0.991-2.104,1.55-3.397,1.55
c-0.186,0-0.372-0.012-0.558-0.035c-10.714-1.338-21.671-2.848-32.567-4.488c-1.62-0.244-2.979-1.35-3.549-2.886
s-0.259-3.26,0.81-4.501l60.565-70.313c1.315-1.527,3.486-1.992,5.31-1.143c8.674,4.042,17.499,7.93,26.228,11.557
c1.332,0.553,2.318,1.712,2.651,3.115s-0.026,2.882-0.967,3.975C230.587,249.343,213.771,268.871,196.221,289.083z
 M258.152,294.775c-0.858,0.986-2.099,1.547-3.395,1.547c-0.116,0-0.232-0.005-0.349-0.014c-11.088-0.86-22.436-1.908-33.73-3.113
c-1.663-0.178-3.089-1.262-3.706-2.816c-0.616-1.554-0.32-3.322,0.77-4.59c15.535-18.087,33.142-38.587,50.54-58.494
c1.236-1.416,3.22-1.912,4.978-1.249c9.632,3.638,18.956,6.847,27.71,9.54c1.452,0.446,2.581,1.596,3.001,3.055
c0.42,1.46,0.076,3.034-0.916,4.185l-3.487,4.045C285.337,263.379,271.895,278.972,258.152,294.775z M358.514,253.671
l-39.318,43.98c-0.855,0.956-2.076,1.501-3.355,1.501c-0.031,0-0.062,0-0.093-0.001c-7.992-0.165-20.372-0.521-33.968-1.279
c-1.71-0.096-3.219-1.154-3.89-2.73c-0.671-1.577-0.389-3.397,0.729-4.696l26.567-30.895c4.845-5.64,9.854-11.472,14.837-17.172
c1.103-1.263,2.816-1.807,4.446-1.412c11.415,2.762,21.855,4.518,31.033,5.218c1.708,0.131,3.193,1.219,3.833,2.808
S359.655,252.395,358.514,253.671z"
                                />
                              </svg>
                              {player.assists}
                            </Badge>
                          )}
                          {player.position_played === "GK" && player.rating >= 7 && (
                            <Badge variant="secondary" className="text-xs flex items-center gap-1">
                              <svg
                                width="12"
                                height="12"
                                viewBox="0 0 480.004 480.004"
                                className="w-3 h-3 fill-current"
                              >
                                <path
                                  d="M477.658,330.346l-13.656-13.656v-20.688c0-2.128-0.84-4.16-2.344-5.656L356.562,185.242l12.016-8.008l39.088,19.544
c0.216,3.736,0.336,7.48,0.336,11.224c0,5.16-0.2,10.328-0.608,15.36l15.952,1.28c0.44-5.464,0.656-11.064,0.656-16.64
c0-16.864-2.024-33.648-6.024-49.888l-15.528,3.832c1.288,5.24,2.272,10.552,3.112,15.896l-27.232-13.616l16.528-38.568
c2.128,4.152,4.072,8.408,5.56,12.88c1.088,3.264,4.136,5.464,7.584,5.464s6.496-2.2,7.584-5.472
c9.224-27.68,31.264-49.72,58.944-58.944c3.272-1.088,5.472-4.136,5.472-7.584s-2.2-6.496-5.472-7.584
c-27.68-9.224-49.72-31.264-58.944-58.944c-1.088-3.272-4.136-5.472-7.584-5.472s-6.496,2.2-7.584,5.472
c-7.224,21.68-22.376,39.8-41.88,51.112C319.81,20.098,269.306,0.002,216.002,0.002c-114.696,0-208,93.304-208,208
c0,16.88,2.032,33.672,6.032,49.904l15.528-3.832c-3.688-14.976-5.56-30.48-5.56-46.072c0-3.776,0.136-7.512,0.352-11.232
l70.808-35.4l20.664,15.496l-97.48,97.48c-1.504,1.496-2.344,3.528-2.344,5.656v20.688L2.346,314.346
c-3.128,3.128-3.128,8.184,0,11.312l136,136c1.56,1.56,3.608,2.344,5.656,2.344c2.048,0,4.096-0.784,5.656-2.344l53.656-53.656
h33.376l5.656,5.656c1.496,1.504,3.528,2.344,5.656,2.344h20.688l61.656,61.656c1.56,1.56,3.608,2.344,5.656,2.344
c2.048,0,4.096-0.784,5.656-2.344l136-136C480.786,338.53,480.786,333.474,477.658,330.346z"
                                />
                              </svg>
                              {Math.floor(player.rating - 5)}
                            </Badge>
                          )}
                          <div
                            className={`px-2 py-1 rounded text-white text-sm font-medium ${getRatingColor(player.rating)}`}
                          >
                            {player.rating.toFixed(1)}
                          </div>
                        </div>
                      </div>
                    </Card>
                  ))}
                </div>
              </div>

              {/* Team B Players */}
              <div>
                <h3 className="text-lg font-semibold mb-3">{match.team_b_name} Players</h3>
                <div className="space-y-2">
                  {getTeamPlayers(match.team_b_name).map((player) => (
                    <Card key={player.id} className="p-3">
                      <div className="flex items-center justify-between">
                        <div className="flex-1">
                          <div className="font-medium">{player.players.name}</div>
                          <div className="text-sm text-muted-foreground">
                            {player.position_played} • {player.minutes_played}'
                          </div>
                        </div>
                        <div className="flex items-center gap-2">
                          {player.goals > 0 && (
                            <Badge variant="secondary" className="text-xs flex items-center gap-1">
                              <svg width="12" height="12" viewBox="0 0 72.371 72.372" className="w-3 h-3 fill-current">
                                <path
                                  d="M22.57,2.648c-4.489,1.82-8.517,4.496-11.971,7.949C7.144,14.051,4.471,18.08,2.65,22.568C0.892,26.904,0,31.486,0,36.186
    c0,4.699,0.892,9.281,2.65,13.615c1.821,4.489,4.495,8.518,7.949,11.971c3.454,3.455,7.481,6.129,11.971,7.949
    c4.336,1.76,8.917,2.649,13.617,2.649c4.7,0,9.28-0.892,13.616-2.649c4.488-1.82,8.518-4.494,11.971-7.949
    c3.455-3.453,6.129-7.48,7.949-11.971c1.758-4.334,2.648-8.916,2.648-13.615c0-4.7-0.891-9.282-2.648-13.618
    c-1.82-4.488-4.496-8.518-7.949-11.971s-7.479-6.129-11.971-7.949C45.467,0.891,40.887,0,36.187,0
    C31.487,0,26.906,0.891,22.57,2.648z M9.044,51.419c-1.743-1.094-3.349-2.354-4.771-3.838c-2.172-6.112-2.54-12.729-1.101-19.01
    c0.677-1.335,1.447-2.617,2.318-3.845c0.269-0.379,0.518-0.774,0.806-1.142l8.166,4.832c0,0.064,0,0.134,0,0.205
    c-0.021,4.392,0.425,8.752,1.313,13.049c0.003,0.02,0.006,0.031,0.01,0.049l-6.333,9.93C9.314,51.579,9.177,51.503,9.044,51.419z
     M33.324,68.206c1.409,0.719,2.858,1.326,4.347,1.82c-6.325,0.275-12.713-1.207-18.36-4.447L33,68.018
    C33.105,68.085,33.212,68.149,33.324,68.206z M33.274,65.735L17.12,62.856c-1.89-2.295-3.59-4.723-5.051-7.318
    c-0.372-0.66-0.787-1.301-1.102-1.99l6.327-9.92c0.14,0.035,0.296,0.072,0.473,0.119c3.958,1.059,7.986,1.812,12.042,2.402
    c0.237,0.033,0.435,0.062,0.604,0.08l7.584,13.113c-1.316,1.85-2.647,3.69-4.007,5.51C33.764,65.155,33.524,65.446,33.274,65.735z
     M60.15,60.149c-1.286,1.287-2.651,2.447-4.08,3.481c-0.237-1.894-0.646-3.75-1.223-5.563l8.092-15.096
    c2.229-1.015,4.379-2.166,6.375-3.593c0.261-0.185,0.478-0.392,0.646-0.618C69.374,46.561,66.104,54.196,60.15,60.149z
     M59.791,40.571c0.301,0.574,0.598,1.154,0.896,1.742l-7.816,14.58c-0.045,0.01-0.088,0.02-0.133,0.026
    c-4.225,0.789-8.484,1.209-12.779,1.229l-7.8-13.487c1.214-2.254,2.417-4.517,3.61-6.781c0.81-1.536,1.606-3.082,2.401-4.627
    l16.143-1.658C56.29,34.495,58.163,37.457,59.791,40.571z M56.516,23.277c-0.766,2.023-1.586,4.025-2.401,6.031l-15.726,1.615
    c-0.188-0.248-0.383-0.492-0.588-0.725c-1.857-2.103-3.726-4.193-5.592-6.289c0.017-0.021,0.034-0.037,0.051-0.056
    c-0.753-0.752-1.508-1.504-2.261-2.258l4.378-13.181c0.302-0.08,0.606-0.147,0.913-0.18c2.38-0.242,4.763-0.516,7.149-0.654
    c1.461-0.082,2.93-0.129,4.416-0.024l10.832,12.209C57.314,20.943,56.95,22.124,56.516,23.277z M60.15,12.221
    c2.988,2.99,5.302,6.402,6.938,10.047c-2.024-1.393-4.188-2.539-6.463-3.473c-0.354-0.146-0.717-0.275-1.086-0.402L48.877,6.376
    c0.074-0.519,0.113-1.039,0.129-1.563C53.062,6.464,56.864,8.936,60.15,12.221z M25.334,4.182c0.042,0.031,0.062,0.057,0.086,0.064
    c2.437,0.842,4.654,2.082,6.744,3.553l-4.09,12.317c-0.021,0.006-0.041,0.012-0.061,0.021c-0.837,0.346-1.69,0.656-2.514,1.031
    c-3.395,1.543-6.705,3.252-9.823,5.301l-8.071-4.775c0.012-0.252,0.055-0.508,0.141-0.736c0.542-1.444,1.075-2.896,1.688-4.311
    c0.472-1.09,1.01-2.143,1.597-3.172c0.384-0.424,0.782-0.844,1.192-1.254c3.833-3.832,8.363-6.553,13.186-8.162
    C25.384,4.098,25.358,4.139,25.334,4.182z"
                                />
                              </svg>
                              {player.goals}
                            </Badge>
                          )}
                          {player.assists > 0 && (
                            <Badge variant="secondary" className="text-xs flex items-center gap-1">
                              <svg
                                width="12"
                                height="12"
                                viewBox="0 0 495.911 495.911"
                                className="w-3 h-3 fill-current"
                              >
                                <path
                                  d="M444.679,320.672c60.387-17.744,65.879-54.018,24.439-73.301c-6.653-3.096-54.633-25.674-61.21-27.957l-1.89-0.656
c-4.9-1.703-9.97-1.791-14.631-0.547c-2.886-3.867-6.919-6.939-11.819-8.641l-1.889-0.658c-4.9-1.701-9.97-1.789-14.631-0.545
c-2.886-3.865-6.919-6.939-11.819-8.643l-1.889-0.656c-4.9-1.701-9.97-1.791-14.631-0.545c-2.886-3.867-6.919-6.939-11.819-8.643
l-1.889-0.656c-4.9-1.701-9.971-1.791-14.631-0.547c-2.886-3.865-6.919-6.939-11.819-8.643l-1.889-0.654
c-5.659-1.967-11.544-1.777-16.765,0.129c-0.182-0.115-0.379-0.234-0.544-0.346c-14.824-9.994-35.158-26.152-48.939-37.283
c-43.333-35-57.647,1.104-73.656,18.482c-3.361,3.65-3.494,7.916-0.884,12.047c1.987,3.145,4.342,6.057,7.75,10.746
c-12.025,1.246-22.703,2.32-33.373,3.469c-12.947,1.391-23.867-2.697-32.767-12.127c-4.546-4.814-8.502-10.287-13.512-14.535
c-4.026-3.412-21.258-10.304-42.02-2.697C0.284,171.067-2.867,278.825,1.514,304.117c2.834,16.355,7.782,22.074,16.04,24.691
l2.909,5.313l-1.239,12.289c-0.636,6.297,2.879,11.637,8.001,12.154c5.123,0.516,9.636-4.014,10.27-10.311l1.24-12.285
l2.816-3.328c13.27,1.924,26.573,3.512,39.92,4.621l3.438,5.35l-0.378,12.346c-0.193,6.326,3.686,11.408,8.831,11.564
c5.146,0.158,9.332-4.674,9.523-11l0.38-12.344l3.244-4.428c6.442,0.219,38.847-15.259,105.731-2.598
c13.168,2.493,26.641,4.123,39.975,4.148c2.721,0.004,5.442-0.004,8.164-0.014l3.393,4.887l0.066,12.35
c0.033,6.328,4.093,11.268,9.24,11.24c5.149-0.027,9.158-5.008,9.123-11.338l-0.064-12.348l3.472-5.113
c15.932-0.344,31.859-0.949,47.763-1.82c2.788-0.154,5.576-0.318,8.363-0.492c0.09,0.125,0.179,0.248,0.282,0.365l4.744,5.314
l1.565,12.25c0.803,6.279,5.432,10.688,10.538,10.035c5.107-0.654,8.481-6.082,7.679-12.361l-1.565-12.25l2.765-5.379
c17.226-1.678,34.345-4.156,51.202-8.143c0.065,0.063,0.125,0.131,0.194,0.189l5.427,4.617l3.225,11.92
c1.654,6.111,6.843,9.846,11.813,8.5s7.569-7.186,5.915-13.295l-3.226-11.922l2.359-6.721
C444.664,320.74,444.668,320.705,444.679,320.672z M196.221,289.083c-0.86,0.991-2.104,1.55-3.397,1.55
c-0.186,0-0.372-0.012-0.558-0.035c-10.714-1.338-21.671-2.848-32.567-4.488c-1.62-0.244-2.979-1.35-3.549-2.886
s-0.259-3.26,0.81-4.501l60.565-70.313c1.315-1.527,3.486-1.992,5.31-1.143c8.674,4.042,17.499,7.93,26.228,11.557
c1.332,0.553,2.318,1.712,2.651,3.115s-0.026,2.882-0.967,3.975C230.587,249.343,213.771,268.871,196.221,289.083z
 M258.152,294.775c-0.858,0.986-2.099,1.547-3.395,1.547c-0.116,0-0.232-0.005-0.349-0.014c-11.088-0.86-22.436-1.908-33.73-3.113
c-1.663-0.178-3.089-1.262-3.706-2.816c-0.616-1.554-0.32-3.322,0.77-4.59c15.535-18.087,33.142-38.587,50.54-58.494
c1.236-1.416,3.22-1.912,4.978-1.249c9.632,3.638,18.956,6.847,27.71,9.54c1.452,0.446,2.581,1.596,3.001,3.055
c0.42,1.46,0.076,3.034-0.916,4.185l-3.487,4.045C285.337,263.379,271.895,278.972,258.152,294.775z M358.514,253.671
l-39.318,43.98c-0.855,0.956-2.076,1.501-3.355,1.501c-0.031,0-0.062,0-0.093-0.001c-7.992-0.165-20.372-0.521-33.968-1.279
c-1.71-0.096-3.219-1.154-3.89-2.73c-0.671-1.577-0.389-3.397,0.729-4.696l26.567-30.895c4.845-5.64,9.854-11.472,14.837-17.172
c1.103-1.263,2.816-1.807,4.446-1.412c11.415,2.762,21.855,4.518,31.033,5.218c1.708,0.131,3.193,1.219,3.833,2.808
S359.655,252.395,358.514,253.671z"
                                />
                              </svg>
                              {Math.floor(player.rating - 5)}
                            </Badge>
                          )}
                          <div
                            className={`px-2 py-1 rounded text-white text-sm font-medium ${getRatingColor(player.rating)}`}
                          >
                            {player.rating.toFixed(1)}
                          </div>
                        </div>
                      </div>
                    </Card>
                  ))}
                </div>
              </div>
            </div>

            {/* Additional Match Info */}
            {(match.location || match.notes) && (
              <Card>
                <CardHeader>
                  <CardTitle className="text-lg">Additional Information</CardTitle>
                </CardHeader>
                <CardContent>
                  {match.location && (
                    <div className="mb-2">
                      <span className="font-medium">Location:</span> {match.location}
                    </div>
                  )}
                  {match.notes && (
                    <div>
                      <span className="font-medium">Notes:</span> {match.notes}
                    </div>
                  )}
                </CardContent>
              </Card>
            )}
          </div>
        )}
      </DialogContent>
    </Dialog>
  )
}
